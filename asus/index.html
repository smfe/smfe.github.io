
<!DOCTYPE html>
<html>
  <head>
    <title>ASUS</title>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <meta property="og:url" content="asuszenfone3.razorfish.sutrix.com">
    <meta property="og:type" content="business.business">
    <meta property="og:title" content="Win A ZenFone 3 Every Day">
    <meta property="og:description" content="Ever dreamt of being a director? Show us your imagination in one line for a chance to win a ZenFone 3! #DirectedByYou">
    <meta property="og:image" content="#DIRECTEDBYYOU">
    <script type="text/javascript" src="//asuszenfone3-razorfish.sutrix.com/assets/js/jquery.min.js"></script>
    <script type="text/javascript" src="//asuszenfone3-razorfish.sutrix.com/assets/js/moment.js"></script>
    <script type="text/javascript" src="//asuszenfone3-razorfish.sutrix.com/assets/js/moment-timezone.js">
      <script type="text/javascript" src="https://connect.facebook.net/en_US/all.js"></script>
    </script>
    <style>
      html, body {
        height: 100%;
      }
      body {
        padding: 0;
        margin: 0;
      }
      iframe {
        border: none;
        margin: 0;
        padding: 0;
        overflow-x: hidden;
        position: absolute;
        top: 0;
        left: 0;
        height: 100%;
        width: 100%;
      }
      .facebook iframe {
        overflow-x: auto;
        position: relative;
        top: 0;
        left: 0;
        height: inherit;
        width: inherit;
      }
    </style>
  </head>
  <body>
    <div id="woobox-root"></div>
    <div class="woobox-offer"></div>
    <script type="text/javascript">
      var refer = document.referrer;
      var isIframe = window !== window.top;
      var isFacebook = (refer.indexOf('facebook.com') > -1 && isIframe);
      if (isFacebook) {
        $('html').addClass('facebook');
      }
      
      function updateIframeContent() {
        setTimeout(function() {
          var woobox = document.getElementsByClassName("woobox-offer")[0];
          var iFrameElement = woobox.getElementsByTagName("iframe")[0];
          // var iFrameElement = $(".woobox-offer").find('iframe');
          if(iFrameElement) {
            iFrameElement.onload = function() {
              iFrameElement.contentWindow.postMessage(isFacebook ? 'facebook' : '' , '*');
            }
          }
        }, 800);
      }
      
      function initWoobox(d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) return;
        js = d.createElement(s); js.id = id;
        js.src = "//woobox.com/js/plugins/woo.js";
        fjs.parentNode.insertBefore(js, fjs);
        updateIframeContent();
      };
      function renderWooboxContent(wooboxId, page) {
        var wooboxOffer = $(".woobox-offer");
        if (isFacebook) {
          wooboxOffer.attr("data-offer", wooboxId);
          initWoobox(document, 'script', 'woobox-sdk');
        } else {
          $('<iframe />', {
              src: '//woobox.com/' + wooboxId + "/" + page,
              width: '100%'
          }).appendTo(wooboxOffer);
          updateIframeContent();
        }
      }
      
      function calcTime() {
        return moment().tz("Asia/Hong_Kong").format('MM.DD.YYYY');
      }
      
      function parseDate(str) {
        var mdy = str.split('.');
        return new Date(mdy[2], mdy[0]-1, mdy[1]);
      }
      
      function diffDay(first, second) {
        return Math.round((second-first)/(1000*60*60*24));
      }
      
      function calcDay(startDay) {
        var diffDays = diffDay(parseDate(startDay), parseDate(calcTime())) + 1;
        return diffDays;
      }
      
      function calcWeek(day) {
        if (day <= 7) {
          return 1;
        } else if (day > 7 && day <= 14) {
          return 2;
        } else if (day > 14){
          return 3;
        }
      }
      
      var domain = "//s3-ap-southeast-1.amazonaws.com/directedbyyou-dev.com/",
          lang = "",
          page = "";
      var arrLang = ["en", "fr", "es", "de", "th"];
      
      var fullPath = document.location;
      var pathname = fullPath.pathname;
      if (pathname != "") {
        pathname = pathname.split("/");
        lang = pathname[pathname.length-2];
      }
      
      if (lang === "" || lang === 'undefined' || $.inArray(lang, arrLang) == -1) {
        lang = "en";
      }
      
      if (fullPath.search != "") {
        page = fullPath.search.split('p=');
        if (page[1] != "") {
          page = page[1];
        }
      }
      
      $.get(domain + "data/custom-url.xml", {}, function (xml){
        startDate = xml.getElementsByTagName("start-date")[0].childNodes[0].nodeValue;
        var curDay = calcDay(startDate);
      
        var langNode = xml.getElementsByTagName(lang)[0];
        var childNode = langNode.getElementsByTagName("gallery")[0];
      
        var week = calcWeek(calcDay(startDate));
        var wooboxId = childNode.getElementsByTagName("week-" + week)[0].childNodes[0].nodeValue;
      
        renderWooboxContent(wooboxId, page);
      });
      
      //- FB.init({
      //-   appId : '255453481519606',
      //-   status : true, // check login status
      //-   cookie : true, // enable cookies to allow the server to access the session
      //-   xfbml : true // parse XFBML
      //- });
      //- window.fbAsyncInit = function() {
      //-   FB.Canvas.setAutoGrow();
      //-   var bodyWidth = $('body').width(),
      //-       bodyHeight = $('body').height();
      //- }
    </script>
    <div id="fb-root"></div>
  </body>
</html>
